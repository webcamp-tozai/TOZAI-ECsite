<% if admin_signed_in? %>

  <%= render 'items/index_admins', {} %> <!-- 変数を再定義する必要有り -->

<% else %>
  <%# ユーザーページ %>
  <div class="container-fluid">
    <div class="row">

      <!-- サイドバー -->
      <%= render 'layouts/sidebar_users', {} %> <!-- 変数を再定義する必要有り -->

      <!-- メインページ -->
      <div class="col-9">
        <%# 新着情報のカルーセルは使用しない
        <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel">
          <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
          </ol>
          <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
              <img class="d-block img-fluid" src="http://placehold.it/900x350" alt="First slide">
            </div>
            <div class="carousel-item">
              <img class="d-block img-fluid" src="http://placehold.it/900x350" alt="Second slide">
            </div>
            <div class="carousel-item">
              <img class="d-block img-fluid" src="http://placehold.it/900x350" alt="Third slide">
            </div>
          </div>
          <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
        %>

        <!-- 新入荷商品一覧 -->
        <div class="row">
          <div class="col-12">
            <p class="text-center my-4 h5 text-white" style="background-color:#B40404;">新着商品</p>
            <div>
              <!--<a href="#">全ての新着商品一覧へ</a>-->
              <table class="table small" style="width: 100%; table-layout: fixed; overflow: hidden;">
                <tbody>
                  <!-- 新着商品 -->
                  <%# 表示件数は3件 %>
                  <% @items.first(3).each do |item|%>
                    <tr>
                      <th scope="row" style="width:15%;">
                        <%= link_to item_path(item) do %>
                          <%= attachment_image_tag item, :image, fallback: "no_image.jpg", class: "card-img", fill: "80x80" %>
                        <% end %>
                      </th>
                      <td style="width:20%; overflow: hidden;">
                      <div class="text-truncate">
                        <span><%= item.created_at.strftime('%Y/%m/%d')%></span><br>
                        <%= link_to item.artist.name, "#" %><br>
                        <%= link_to item.title, item_path(item) %>
                      </div>
                      </td>
                      <td style="width:65%;">
                        <div style="height: 6.4em; line-height: 1.6; overflow: hidden;">
                          <%= item.item_introduction %>
                        </div>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- 商品一覧 -->
        <div class="row">
          <div class="col-12">
             <p class="text-center my-4 h5 text-white" style="background-color:#B40404;">商品一覧</p>
          </div>

          <!-- 商品 -->
          <% @items.each do |item| %>
            <div class="col-3 mb-4">
              <div class="text-truncate" style="overflow: hidden;">
                <!-- ジャケット画像 -->
                <%= attachment_image_tag item, :image, fallback: "no_image.jpg", class: "card-img" %>
                <!-- ジャンル、アーティスト名、商品名 -->
                <div class="mt-3 text-truncate">
                  <%= link_to item.genre.genre_english, genres_path(item), class: "btn btn-sm btn-secondary" %><br>
                  <%= link_to item.artist.name, artists_path(item), class: "font-weight-bold", style: "color: #0033cc; font-size: 18px;" %><br>
                  <%= link_to item.title, item_path(item), class: "font-weight-bold", style: "color: #1a1a1a;" %><br>
                </div>
                <!-- 税込価格 -->
                <div class="mt-2">
                  <span class="text-dark small">
                    <%= number_to_currency item.price_without_tax, :unit => "￥", :precision => 0 %>
                  </span><br>
                  <!-- 在庫が20以下の場合 -->
                  <% if item.stock <= 20 && item.stock >= 1 %>
                    <span class="text-danger small">
                      在庫残り<%= item.stock %>点
                    </span>
                  <!-- 在庫切れの場合 -->
                  <% elsif item.stock == 0 && item.is_deleted == false %>
                    <span class="text-secondary small">
                      【在庫切れ】再入荷中
                    </span>
                  <!-- 削除フラグtrueの場合 -->
                  <% elsif item.is_deleted == true %>
                    <span class="text-secondary small">
                      取扱終了
                    </span>
                  <!-- 在庫が21以上の場合 -->
                  <% else %>
                    <span class="text-dark small font-weight-bold">
                      在庫有り
                    </span>
                  <% end %>

                </div>

              </div>
            </div>

          <% end %>

        </div><!-- 商品一覧rowの閉じタグ -->

        <div class="row">
          <div class="col-12">
            <nav aria-label="Page navigation example">
              <ul class="pagination justify-content-center">
                <li class="page-item">
                  <%= paginate @items %>
                </li>
                <!--<li class="page-item"><a class="page-link" href="#">Previous</a></li>-->
                <!--<li class="page-item"><a class="page-link" href="#">1</a></li>-->
                <!--<li class="page-item"><a class="page-link" href="#">2</a></li>-->
                <!--<li class="page-item"><a class="page-link" href="#">3</a></li>-->
                <!--<li class="page-item"><a class="page-link" href="#">Next</a></li>-->
              </ul>
            </nav>
          </div>
        </div>

      </div><!-- メインページの閉じタグ -->
    </div><!-- 全体rowの閉じタグ -->
  </div><!-- 全体containerの閉じタグ -->

<% end %>